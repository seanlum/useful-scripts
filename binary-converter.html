<!DOCTYPE html>
<html lang="en-US">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
<title>Binary Calculator</title>
</head>
<body>
<div class="output-view">
  <span class="control-title">Binary Bit-Width</span>
    <input type="number" oninput="doBin2Array()" id="bin2arr-width" value="8" />
  <span class="control-title">Binary Number</span>
    <textarea oninput="doBin2Array()" id="bin2arr-number">01011011</textarea>
  <span class="control-title">Binary to Integers output</span>
    <textarea id="bin2arr-output"></textarea>
</div>

<div class="output-view">
  <span class="control-title">Bit Width</span>
    <input type="number" oninput="doI2Bin()" id="i2bin-width" value="8" />
  <span class="control-title">Number to Convert To Binary</span>
    <textarea oninput="doI2Bin()" id="i2bin-number">11</textarea>
  <span class="control-title">Binary to Integers output</span>
    <textarea id="i2bin-output"></textarea>
</div>


<div class="output-view">
  <span class="control-title">LAN IP to Binary</span>
  <textarea oninput="doIP2bin()" id="i2bin-ip-num">192.168.1.1</textarea>
  <span class="control-title">Binary to Integers output</span>
  <textarea id="i2bin-ip-output"></textarea>
</div>

<div class="output-view">
  <span class="control-title">CIDR Notation</span>
  <textarea oninput="doCIDR2Bin()" id="cidr2bin-network-id">192.168.1.1/24</textarea>
  <span class="control-title">Network ID Information</span>
  <textarea id="cidr2bin-network-id-info" style="height: 400px;"></textarea>
</div>

<style type="text/css">
body {
  background: forestgreen;
  margin: 0;
  padding: 0;
}
.output-view {
  position: relative;
  float: left;
  font-family: sans-serif;
  font-weight: bold;
  color: #fff;
  text-shadow: 1px 1px 2px #000;
  width: 400px;
  padding: 25px;
  margin: 10px 5px;
  box-shadow: 1px 1px 2px rgba(0,0,0,0.6);
  background: linear-gradient(to bottom left,
    rgba(255,255,255,0.4),
    rgba(255,255,255,0.4),
    rgba(255,255,255,0.2),
    rgba(255,255,255,0.3));
}

.output-view input,
.output-view textarea {
  background: rgba(255,255,255,0.4);
  word-break: break-all;
  font-weight: bold;
  font-size: 0.8rem;
  text-shadow: 0 0 3px #fff;
  color: #111;
  box-shadow: 1px 1px 2px rgba(0,0,0,0.6);
  border: 1px solid rgba(255,255,255, 0.4);
  position: relative;
  clear: both;
  width: 94%;
  padding: 2%;
  display: block;
  margin: 0.25rem 0 0.5rem 0;
}

.output-view textarea {
  height: 100px;
}

.control-title {
  display: block;
  margin-top: 0 0 1rem 0;
}

@media all and (max-width: 1000px) {
  .output-view {
    width: 78%;
    padding: 5%;
    margin: 5%;
  }
}
</style>
<script type="text/javascript">
  /*
     Written by seanlum
     GitHub: https://www.github.com/seanlum/
  */
  function bin2Array(binaryString, bitWidth) {
    binaryString = String(binaryString).split(/[^01]+/).join('');
    bitWidth = Number(bitWidth);
    function bin2num(binaryNumber) {
      return binaryNumber.split('')
      .map(function(bit, bitIndex, numberOrigin) {
        return Number(bit);
      })
      .reduce(function(accumulator,
          currentValue, currentIndex, origin) {
            if (currentValue === 1) {
              return Math.pow(2, currentIndex) + accumulator;
            } else {
              return accumulator;
            }
      });
    }

    if (binaryString.length >= bitWidth) {
      let outNumbers = [];
      let processString = binaryString.split('').reverse().join('');
      for(let bitPosition = 0; bitPosition < processString.length; bitPosition += bitWidth) {
        outNumbers.push(
          bin2num(String(processString.substring(bitPosition, bitPosition + bitWidth)))
        );
      }
      return outNumbers.reverse();
    } else {
      return bin2num(binaryString.split('').reverse().join(''));
    }
  }

  function i2bin(number, bitWidth) {
    let outString = '';
    let remainder = Number(number);
    for(;bitWidth > 0;bitWidth--) {
      currentPlace = Math.pow(2, bitWidth);
      lowerPlace = Math.pow(2, bitWidth - 1);
  /*
      128  64  32  16  8  4  2  1

      128 > 7, 64 > 7, 32 > 7, 16 > 7, 8 > 7  #  note 4 !> 7  00000
      bitWidth                                #               2^3 = 8
      8 > 7, 4 <= 7, 7 - 4 = 3                #               000001
      bitWidth--                              #               2^2 = 4
      4 > 3, 2 <= 3, 3 - 2 = 1                #               0000011
      bitWidth--                              #               2^1 = 2
      2 > 1, 1 <= 1, 1 - 1 = 0                #               00000111
      bitWidth--                              #               2^0 = 1
      1 > 0... loop breaks, limit reached     #
  */
      if ((currentPlace > remainder) && (lowerPlace <= remainder)) {
           remainder -= lowerPlace;
           outString += '1';

      } else {
          outString += '0';
      }
    }
    return outString;
  }


  function doI2Bin() {
    let calcView = document.getElementById('i2bin-output');
    let binString = document.getElementById('i2bin-number');
    let binWidth = document.getElementById('i2bin-width');
    let result = i2bin(binString.value, binWidth.value);
    calcView.innerHTML = result.toString();
  }

  function doBin2Array() {
    let calcView = document.getElementById('bin2arr-output');
    let binString = document.getElementById('bin2arr-number');
    let binWidth = document.getElementById('bin2arr-width');
    let result = bin2Array(binString.value, binWidth.value);
    calcView.innerHTML = result.toString();
  }

  function doIP2bin() {
    let calcView = document.getElementById('i2bin-ip-output');
    let binString = document.getElementById('i2bin-ip-num');
    let numbers = binString.value.split(/[^0-9]/).map(function(num, index, origin) {
      return i2bin(num, 8);
    }).join('.');
    calcView.innerHTML = numbers.toString();
  }

  function doCIDR2Bin() {
    let calcView = document.getElementById('cidr2bin-network-id-info');
    let cidrString = document.getElementById('cidr2bin-network-id');
    let info = cidrString.value.split(/\//);
    let defaultSubnetMask = '';
    let IPClass = '';
    let binaryIP = info[0].split(/[^0-9]/).map(function(num, index, origin) {
      if (index === 0) {
        if ((1 <= num) && (num <= 126)) {
          defaultSubnetMask = '255.0.0.0';
          IPClass = 'A';
        } else if ((128 <= num) && (num <= 191)) {
          defaultSubnetMask = '255.255.0.0';
          IPClass = 'B';
        } else if ((192 <= num) && (num <= 223)) {
          defaultSubnetMask = '255.255.255.0';
          IPClass = 'C';
        } else if ((224 <= num) && (num <= 239)) {
          defaultSubnetMask = '---';
          IPClass = 'D';
        } else if ((240 <= num) && (num <= 255)) {
          defaultSubnetMask = '---';
          IPClass = 'E';
        } else {
          defaultSubnetMask = '---';
          IPClass = 'X';
        }
      }
      return i2bin(num, 8);
    }).join('.');

    let subnetMask = Number(info[1]);

    let binaryNetmaskString = '';
    for (let notation=1; notation <= 32; notation++) {
      if (notation > subnetMask) {
        binaryNetmaskString += '0';
      } else {
        binaryNetmaskString += '1';
      }
      if (((notation % 8) === 0) && notation < 32) {
        binaryNetmaskString += '.';
      }
    }

    let netmaskString = binaryNetmaskString.split('.').map(function(binNum, index, origin) {
      return bin2Array(binNum, 8);
    }).join('.');

    calcView.innerHTML = 'Network Class: ' + IPClass +
    '\nDefault Netmask: ' + defaultSubnetMask +
    '\n\nNetmask: ' +  netmaskString +
    '\nNetwork Bits: ' + (Number(info[1])) +
    '\nHost Bits: ' + (32 - Number(info[1])) +
    '\n\nNetmask (binary):\n' + binaryNetmaskString +
    '\nIP (binary):\n' + binaryIP;
  }

  document.addEventListener('DOMContentLoaded', function(event) {
    doI2Bin();
    doBin2Array();
    doIP2bin();
    doCIDR2Bin();
  });
</script>
</body>
</html>
